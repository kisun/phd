<html>
<head>
	<meta charset="utf-8" />
	<meta name="generator" content="R package animation 2.4">
	<title>Animations Using the R Language</title>
	<link rel="stylesheet" href="css/reset.css" />
	<link rel="stylesheet" href="css/styles.css" />
	<link rel="stylesheet" href="css/scianimator.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/styles/github.min.css">

	<script src="js/jquery-1.4.4.min.js"></script>
	<script src="js/jquery.scianimator.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/highlight.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/languages/r.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

</head>
<body>

	<div class="scianimator"><div id="arrival_time_predictions" style="display: inline-block;"></div></div>
	<div class="scianimator" style="width: 900px; text-align: left"><pre><code class="r">## Animations generated in R version 3.2.3 (2015-12-10) using the package animation
<<<<<<< HEAD
=======
library(animation)
>>>>>>> cbd436c5bad90949124f572244aee801fd11d901
library(mvtnorm)
library(iNZightMaps)
library(iNZightPlots)
library(jsonlite)
library(RPostgreSQL)
library(DBI)
<<<<<<< HEAD
for (k in 1:400) {
    dev.hold()
    plot(NA, xlim = c(0, 90 * 60), ylim = c(0, M) + 0.5, 
        xlab = "Arrival Time (min after trip start)", xaxs = "i", 
        xaxt = "n", ylab = "Stop #", yaxs = "i", yaxt = "n")
    abline(h = 2:M - 0.5, lty = 3, col = "#cccccc")
    axis(2, at = 1:M, las = 1, tick = FALSE)
    axis(1, at = pretty(c(0, 90)) * 60, labels = pretty(c(0, 
        90)))
    for (j in 2:M) {
        Ta <- arrivaltimes[arrivaltimes$trip_id == vps[ind[k], 
            "trip_id"], ]
        if (nrow(Ta) > 0) {
            delays <- sapply(unique(Ta$stop_sequence), function(s) {
              arr <- Ta[Ta$stop_sequence == s & Ta$arrival_delay != 
                0, "arrival_delay"]
              dep <- Ta[Ta$stop_sequence == s & Ta$departure_delay != 
                0, "departure_delay"]
              if (length(arr) == 0 & length(dep) == 0) 
                (c(NA, NA))
              if (length(arr) == 0) 
                return(rep(max(dep), 2))
              if (length(dep) == 0) 
                return(rep(max(arr), 2))
              return(c(max(arr), max(dep)))
            })
            dimnames(delays) <- list(c("arrival", "departure"), 
              unique(Ta$stop_sequence))
            St <- infoList[[vps[ind[k], "trip_id"]]]$schedule[, 
              c("pivot.arrival_time", "pivot.departure_time")]
            St[, 1] <- as.numeric(as.POSIXct(paste(vps[ind[k], 
              "trip_start_date"], St[, 1]), origin = "1970-01-01"))
            St[, 2] <- as.numeric(as.POSIXct(paste(vps[ind[k], 
              "trip_start_date"], St[, 2]), origin = "1970-01-01"))
            St <- as.matrix(St)
            for (s in as.character(unique(Ta$stop_sequence))) {
              delays[, s] <- St[s, ] + delays[, s] - min(St)
              lines(delays[, s], rep(as.numeric(s), 2) + 
                0.3, col = "orangered", lwd = 2)
            }
        }
=======
for (k in 1:length(ind)) {
    dev.hold()
    plot(NA, xlim = range(PRED, na.rm = TRUE), ylim = c(0, 
        M) + 0.5, xlab = "Arrival Time", xaxt = "n", ylab = "Stop #", 
        yaxs = "i", yaxt = "n")
    abline(h = 2:M - 0.5, lty = 3, col = "#cccccc")
    axis(2, at = 1:M, las = 1, tick = FALSE)
    for (j in 2:M) {
>>>>>>> cbd436c5bad90949124f572244aee801fd11d901
        points(PRED[j, , k, 1], rep(j - 0.5, N), pch = 19, 
            cex = 0.2)
        points(PRED[j, , k, 2], rep(j - 0.3, N), pch = 19, 
            cex = 0.2, col = "#990000")
        points(PRED[j, , k, 3], rep(j - 0.1, N), pch = 19, 
            cex = 0.2, col = "#009900")
        points(PRED[j, , k, 4], rep(j + 0.1, N), pch = 19, 
            cex = 0.2, col = "#000099")
    }
    legend("bottomright", legend = rev(c("Schedule", "Schedule Deviation", 
        "Vehicle State", "Traffic State")), col = rev(c("black", 
        "#990000", "#009900", "#000099")), pch = 19, cex = 0.8, 
        bty = "n")
    dev.flush()
}
## R version 3.2.3 (2015-12-10)
## Platform: x86_64-pc-linux-gnu (64-bit)
<<<<<<< HEAD
## Other packages: mvtnorm 1.0-5, iNZightMaps 1.1, iNZightPlots 2.4, jsonlite 0.9.19, RPostgreSQL
## 0.4-1, DBI 0.3.1</code></pre></div>
=======
## Other packages: animation 2.4, mvtnorm 1.0-5, iNZightMaps 1.1,
## iNZightPlots 2.4, jsonlite 0.9.19, RPostgreSQL 0.4-1, DBI
## 0.3.1</code></pre></div>
>>>>>>> cbd436c5bad90949124f572244aee801fd11d901
	<script src="js/arrival_time_predictions.js"></script>
<!-- highlight R code -->

</body>
</html>
